<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>הדמיית שיחה — ברומטר (תצוגת מחשב)</title>
  <style>
    :root {
      --bg: #e9edf3;
      --win: #ffffff;
      --border: #d8dee9;
      --text: #1f2937;
      --user: #e3f6d4;
      --bot: #eef1f5;
      --note: #fff5d7;
      --muted: #6b7280;
      --highlight: #fff3cd;
    }
    * { box-sizing: border-box; }
    body {
      margin: 0;
      background: var(--bg);
      font-family: "Segoe UI", Tahoma, Arial, sans-serif;
      color: var(--text);
      display: grid;
      place-items: center;
      height: 100vh;
    }

    .window {
      width: 960px;
      height: 640px;
      background: var(--win);
      border: 1px solid var(--border);
      border-radius: 10px;
      box-shadow: 0 12px 30px rgba(0,0,0,.12);
      display: grid;
      grid-template-rows: 44px auto 36px;
      overflow: hidden;
    }
    .titlebar {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 0 12px;
      border-bottom: 1px solid var(--border);
      background: linear-gradient(#fbfbfc, #f3f5f8);
      user-select: none;
    }
    .traffic { display: flex; gap: 8px; margin-inline-end: 8px; }
    .dot { width: 12px; height: 12px; border-radius: 50%; }
    .dot.red { background: #ff5f56; }
    .dot.yellow { background: #ffbd2e; }
    .dot.green { background: #27c93f; }
    .titlebar h1 { font-size: 14px; font-weight: 600; margin: 0; }

    .chat { display: flex; flex-direction: column; padding: 16px 20px; overflow-y: auto; gap: 10px; }
    .row { display: flex; align-items: flex-end; gap: 8px; }
    .row.user { justify-content: flex-end; }
    .row.bot { justify-content: flex-start; }

    .avatar {
      width: 28px; height: 28px; border-radius: 50%;
      display: grid; place-items: center; font-size: 12px; font-weight: 700;
      color: #374151; background: #e5e7eb; flex: 0 0 28px; user-select: none;
    }

    .bubble {
      max-width: 70%;
      padding: 10px 14px;
      border-radius: 12px;
      box-shadow: 0 1px 2px rgba(0,0,0,.06);
      white-space: pre-wrap;
      opacity: 0; transform: translateY(8px);
      animation: fadeIn .5s forwards ease-out;
    }
    .bubble.user { background: var(--user); }
    .bubble.bot { background: var(--bot); }
    .bubble.highlight { background: var(--highlight); border: 2px solid #ffec99; }

    .gap { width: 100%; display: grid; place-items: center; }
    .gap .label {
      max-width: 80%; background: var(--note); border: 1px dashed #e9c46a;
      border-radius: 999px; padding: 8px 14px; font-size: 13px; color: #7c5a00; text-align: center;
      opacity: 0; transform: translateY(8px); animation: fadeIn .5s forwards ease-out;
    }

    .statusbar { font-size: 12px; color: var(--muted); display: flex; align-items: center; justify-content: space-between; padding: 0 12px; border-top: 1px solid var(--border); background: #fafbfc; gap: 12px; }
    .controls { display: flex; align-items: center; gap: 8px; }
    button { border: 1px solid var(--border); background: white; border-radius: 8px; padding: 4px 10px; cursor: pointer; }
    button:hover { background: #f6f7f9; }
    input[type="range"]{ width: 160px; }

    @keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
  <div class="window">
    <div class="titlebar">
      <div class="traffic"><span class="dot red"></span><span class="dot yellow"></span><span class="dot green"></span></div>
      <h1>שיחה על שאלה בברומטר</h1>
    </div>

    <div class="chat" id="chat"></div>

    <div class="statusbar">
      <div class="controls">
        <button id="playPause">השהה</button>
        <label>מהירות: <input type="range" id="speed" min="0.5" max="2" step="0.25" value="1"></label>
      </div>
      <span id="counter">0/0</span>
    </div>
  </div>

  <script>
    const BASE_DELAY_MS = 2200;

    const script = [
      { type: 'msg', sender: 'user', text: 'אני צריכה שאלה קצרה על ברומטר לתרגול.' },
      { type: 'msg', sender: 'bot', text: 'הנה כמה אפשרויות – שאלה על עקרון הפעולה, שאלה חישובית פשוטה, או שאלה על ההבדל בין לחץ ברומטרי ללחץ מוחלט. רוצה שאבחר אחת ואנוסח אותה לפי סגנון השאלות בספר?' },
      { type: 'gap', note: 'כאן הופיעו 3 דוגמאות לשאלות מסוגים שונים' },
      { type: 'msg', sender: 'user', text: 'כן, אבל עדיף שאלה חישובית – אולי קצת יותר מורכבת.' },
      { type: 'msg', sender: 'bot', text: 'אפשר למשל לשלב חישוב של ברומטרי ומנומטרי באותה סיטואציה.' },
      { type: 'msg', sender: 'user', text: 'אני מחפשת משהו שממחיש את ההבדל בין לחץ יחסי ללחץ אבסולוטי – לא רק נתונים, אלא סיטואציה.' },
      { type: 'msg', sender: 'bot', text: 'מצוין. נוכל לתאר מהנדסת שבודקת מכל גז, כשהלחץ האטמוספרי ביום הבדיקה נמוך מהרגיל.' },
      { type: 'gap', note: 'כאן הופיעה הודעת ביניים: בחירת התרחיש והקשר ההנדסי' },
      { type: 'msg', sender: 'user', text: 'אולי נוסיף גם המרה ליחידות אחרות – נגיד שהלחץ האטמוספרי נמדד ב-mmHg?' },
      { type: 'msg', sender: 'bot', text: 'רעיון טוב. זה מוסיף עומק מושגי ותרגול שימושי.\n(מעדכנת את השאלה עם נתון של 720 mmHg ומוסיפה חישוב ל-kPa)' },
      { type: 'gap', note: 'כאן הופיעה הודעת ביניים: המרות יחידות ודוגמאות נגדיות קצרות' },
      { type: 'msg', sender: 'user', text: 'נחמד. אולי נוסיף אלמנט הנדסי – נניח שהמהנדסת צריכה לבדוק שהמכל לא חורג מהלחץ המותר.' },
      { type: 'msg', sender: 'bot', highlight: true, text: `נהדר — זה יכניס לשאלה ממד הנדסי אמיתי, שבו הלחץ האבסולוטי רלוונטי לבטיחות המיכל.\nהנה הגרסה המעודכנת, עם ההקשר של תקינות מערכת:\n________________________________________\n🧭 שאלה לתרגול – לחץ אבסולוטי, לחץ מדומה ובדיקת תקינות מיכל\nמהנדסת תהליך בודקת מכל גז במפעל.\nמד הלחץ (Gauge) המותקן על המכל מראה 200 kPa.\nהלחץ האטמוספרי באותו היום נמדד בברומטר כספית ועמד על 720 mmHg.\nידוע כי המכל מתוכנן לעמוד בלחץ אבסולוטי מרבי של 310 kPa.\nא. חשבו את הלחץ האטמוספרי ביחידות ‎kPa‎.\n(נתון: 1 atm = 760 mmHg = 101.3 kPa)\nב. חשבו את הלחץ האבסולוטי במכל.\nג. האם המכל נמצא בתחום התקין או שקיים חשש לחריגה מהלחץ המותר? נמקו.\nד. הסבירו במילים – אם ביום אחר הלחץ האטמוספרי היה גבוה יותר, אך מד הלחץ הראה שוב 200 kPa, כיצד הייתה משתנה רמת הבטיחות של המכל?` }
    ];

    const chat = document.getElementById('chat');
    const counter = document.getElementById('counter');
    const playPauseBtn = document.getElementById('playPause');
    const speedInput = document.getElementById('speed');

    counter.textContent = `0/${script.length}`;

    function addMessage(entry){
      if(entry.type === 'gap'){
        const wrap = document.createElement('div');
        wrap.className = 'gap';
        wrap.innerHTML = `<div class="label">— ${entry.note} —</div>`;
        chat.appendChild(wrap);
        chat.scrollTop = chat.scrollHeight;
        return;
      }
      const row = document.createElement('div');
      row.className = `row ${entry.sender}`;

      const avatar = document.createElement('div');
      avatar.className = 'avatar';
      avatar.textContent = entry.sender === 'user' ? 'את' : 'AI';

      const bubble = document.createElement('div');
      bubble.className = `bubble ${entry.sender}${entry.highlight ? ' highlight' : ''}`;
      bubble.textContent = entry.text;

      if(entry.sender === 'user'){
        row.appendChild(bubble);
        row.appendChild(avatar);
      } else {
        row.appendChild(avatar);
        row.appendChild(bubble);
      }
      chat.appendChild(row);
      chat.scrollTop = chat.scrollHeight;
    }

    let i = 0;
    let timer = null;
    function step(){
      if(i >= script.length){ timer && clearTimeout(timer); return; }
      addMessage(script[i]);
      i += 1;
      counter.textContent = `${i}/${script.length}`;
      const delay = BASE_DELAY_MS / parseFloat(speedInput.value || '1');
      timer = setTimeout(step, delay);
    }

    step();

    let playing = true;
    playPauseBtn.addEventListener('click', ()=>{
      if(playing){
        playing = false; playPauseBtn.textContent = 'נגן';
        timer && clearTimeout(timer);
      } else {
        playing = true; playPauseBtn.textContent = 'השהה';
        step();
      }
    });
  </script>
</body>
</html>
